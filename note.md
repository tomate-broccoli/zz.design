# めも

## やりたいこと
  - 要件や設計のためのツールを作成する。
  - イベントストームやDDDでの利用を想定。
  - HTMLで表示てきること。
  - marmaid.jsで表示できること。
  - GITで管理できること。
  - あまり考えることなく機械的にテキパキと作業が進むこと。

## 作業手順

### ドメインイベント
  - ドメインイベントを洗い出す
  - 時系列に並び替える
  - ドメインイベントを紐付ける
    - ドメインイベントに識別子(ID)を割当てる
    - リンク先のIDを記述する(linkTo).

#### 課題など
- Q.ドメインイベントの粒度が異なる
  - 画面上の操作(例：○○ボタンを押下した)が含まれる
  - エンティティレベルの操作(例：履歴を記録した)が含まれる
  - ユースケースレベル(例：顧客情報を最新化した)が含まれる.
  - その他(例：配送完了メールを受信した)が含まれる
- A.
  - 分類できるようにタグ付けする(例: .class(command|view|action|event|...))

- Q.クエリ(例：商品を参照した)が含まれる
- A. 
  - 分類できるようにタグ付けする(例: .class(command|view|action|event|...))

- Q.ドメインイベントが多いとID付与の作業が大変になる
- A. 
  - viの置換コマンドとかで一括付与する

- Q.ドメインイベントが多いとリンク先のIDの設定が大変になる
- A. 
  - viの置換コマンドとかで一括付与する

- Q.ドメインイベントが多いと紐付け作業が大変になる
- A. 
  - viの画面分割コマンドや、検索一覧コマンドを活用する

- Q.ドメインイベントの追加などでリンク先変更時の作業が大変になる
- A. 
  - viの画面分割コマンドや、検索一覧コマンドを活用する
  - viスクリプトでマップおよび置換コマンドによる再採番などを検討する

- Q.ドメインイベントにコメント(注釈、メモ、備考、補足など)を付与したい
- A.コメント付与できるようにする(例：.note(ほげほげ)) 

### コマンド
- ドメインイベントを参考にコマンドを作成する
- 基本はドメインイベントの過去形を現在系にする(だけ)

### ポリシー
- ドメインイベントのリンク先(linkTo)のコマンドが呼び出される条件があれば記載する。

#### 課題など
- Q.時系列のため紐付けされているが、ポリシーを満たしたら呼出されるような関係ではない.
- A.
  - アクターによる判断などに依存する場合は「アクターの判断による」とでもしておく(？)
  - アクターによる判断などに依存する場合はポリシーの定義は不要とする.

- Q.ポリシーは呼出元(from)に定義すべきか？それても呼出先(to)に定義すべきか？
- A.
  - 呼出先(to)に定義する(例: .policy(ほげほげ))

### アクタ
- コマンドをアクターが実行する場合、アクターを設定する(例：.actor(顧客)).

### リードモデル(ビュー)
- アクタがコマンドを実行する判断材料となるビューを設定する(例：.view(商品データ))

### 集約
- 集約名を設定する(例：.aggregation(商品))
- 基本はコマンドの目的語(例：顧客情報)を設定する(だけ)

#### 課題など
- Q.集約ではなく「外部システム」の場合は？
- A.
  - 集約は「.aggregation()」とし、外部システムは「.outerService()」する(例：.outerService(メールシステム))

### ここまでについて
- 以下の要素が洗い出されたはず
  - ドメインイベント: domainEvent
    - id
    - linkTo
    - note
  - コマンド: command
    - note
    - class
  - ポリシー: policy
    - note
  - アクター: actor
    - note
  - リードモデル(ビュー): view
    - note
  - 集約: aggregation
    - note
  - 外部システム: outerServcie
    - note

ここからは、
- 集約中心の話になる
- データの状態に変更が想定される集約に絞る

### 境界付けされたコンテキスト
- 各ドメインイベント(とそれに対応するアクタ、コマンド、集約など)

__END__